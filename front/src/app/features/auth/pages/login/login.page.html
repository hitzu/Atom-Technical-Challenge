@if (successMessage()) {
<div class="alert alert-success" role="status">{{ successMessage() }}</div>
} @if (errorMessage()) {
<p class="atom-login-error-banner">{{ errorMessage() }}</p>
}

<div class="atom-login-layout">
  <div class="atom-login-brand-panel" aria-hidden="true">
    <img
      src="assets/atom-logo.png"
      alt="Atom logo"
      class="atom-login-logo-main"
      loading="eager"
      decoding="async"
    />
  </div>

  <div class="atom-login-form-panel">
    <div class="atom-login-card">
      <div class="login-form-logo d-block d-lg-none">
        <img
          src="assets/atom-logo.png"
          alt="Atom logo"
          class="atom-login-logo-inline"
          loading="eager"
          decoding="async"
        />
      </div>
      <h1 class="atom-login-title">Atom Tasks</h1>
      <p class="atom-login-help">Ingresa tu email para continuar.</p>

      <form class="atom-login-form" [formGroup]="form" (ngSubmit)="onSubmit()">
        <div class="atom-login-field">
          <label class="atom-login-label" for="email">Email</label>
          <input
            class="atom-login-input"
            id="email"
            type="email"
            formControlName="email"
            autocomplete="email"
            inputmode="email"
            [attr.aria-invalid]="form.controls.email.invalid && form.controls.email.touched ? 'true' : 'false'"
            [disabled]="isSubmitting()"
          />
          @if (form.controls.email.invalid && form.controls.email.touched) {
          <span class="atom-login-error">Ingresa un email válido.</span>
          }
        </div>

        @if (errorMessage()) {
        <p class="atom-login-error-banner">{{ errorMessage() }}</p>
        }

        <button
          class="atom-login-submit"
          type="submit"
          [disabled]="form.invalid || isSubmitting()"
        >
          {{ isSubmitting() ? 'Procesando...' : 'Iniciar sesión' }}
        </button>
      </form>
    </div>
  </div>
</div>

@if (isCreateUserModalOpen()) {
<div
  class="atom-modal-backdrop"
  aria-hidden="true"
  (click)="closeCreateUserModal()"
></div>

<div
  class="atom-modal"
  role="dialog"
  aria-modal="true"
  aria-label="Confirmar creación de usuario"
>
  <div class="atom-modal__card" (click)="$event.stopPropagation()">
    <h2 class="atom-modal__title">Usuario no encontrado</h2>
    <p class="atom-modal__text">
      El usuario
      <span class="atom-modal__email">{{ pendingEmail() }}</span>
      no existe. ¿Deseas crearlo?
    </p>

    <div class="atom-modal__actions">
      <button
        type="button"
        class="atom-modal__btn atom-modal__btn--secondary"
        (click)="closeCreateUserModal()"
        [disabled]="isSubmitting()"
      >
        Cancelar
      </button>

      <button
        type="button"
        class="atom-modal__btn atom-modal__btn--primary"
        (click)="confirmCreateUser()"
        [disabled]="isSubmitting()"
      >
        {{ isSubmitting() ? 'Creando...' : 'Crear usuario' }}
      </button>
    </div>
  </div>
</div>
}
